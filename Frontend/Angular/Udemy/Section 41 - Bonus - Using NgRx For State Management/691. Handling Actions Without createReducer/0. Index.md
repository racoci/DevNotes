# 691. Handling Actions Without createReducer

> Duração: `6min`

Sem Recursos

WEBVTT

1
00:00:02.130 --> 00:00:04.860
<v Maximilian>So you now learn about actions.</v>

2
00:00:04.860 --> 00:00:08.670
Earlier in this section, you learn about reducers

3
00:00:08.670 --> 00:00:13.670
and this alternative way of defining your reducer functions.

4
00:00:14.130 --> 00:00:18.870
And now I want come back to this alternative approach.

5
00:00:18.870 --> 00:00:21.330
I wanna redefine this reducer

6
00:00:21.330 --> 00:00:24.960
which now does contain some state changing logic

7
00:00:24.960 --> 00:00:26.640
using this syntax,

8
00:00:26.640 --> 00:00:28.233
so without createReducer.

9
00:00:29.520 --> 00:00:32.280
And I wanna do the same for the action

10
00:00:32.280 --> 00:00:36.600
and show you how you could build such a action thing

11
00:00:36.600 --> 00:00:39.840
such a action function as you learned

12
00:00:39.840 --> 00:00:42.780
since this action is executed like a function

13
00:00:42.780 --> 00:00:45.780
inside of the component that should dispatch it.

14
00:00:45.780 --> 00:00:49.410
I wanna show you how you can build it without createAction.

15
00:00:49.410 --> 00:00:51.660
And of course, don't get me wrong,

16
00:00:51.660 --> 00:00:55.350
it's absolutely recommended to use createAction

17
00:00:55.350 --> 00:01:00.150
and createReducer unless you really don't like that syntax.

18
00:01:00.150 --> 00:01:02.550
But as you are using your knowledge

19
00:01:02.550 --> 00:01:06.360
you gain in this course on real world projects,

20
00:01:06.360 --> 00:01:10.710
you could encounter a project that does not use this syntax

21
00:01:10.710 --> 00:01:14.190
that does not use createReducer and createAction.

22
00:01:14.190 --> 00:01:17.310
And that's why I'm showing you this alternative syntax,

23
00:01:17.310 --> 00:01:20.460
though I'm of course also showing this syntax to you

24
00:01:20.460 --> 00:01:22.950
because it allows you to understand

25
00:01:22.950 --> 00:01:24.933
what's going on under the hood.

26
00:01:26.370 --> 00:01:28.620
So let's start with the reducer.

27
00:01:28.620 --> 00:01:31.830
Instead of creating it with createReducer

28
00:01:31.830 --> 00:01:34.410
and by using this on function

29
00:01:34.410 --> 00:01:37.230
which is provided by NgRx store,

30
00:01:37.230 --> 00:01:41.010
you can create your reducer as a standard function

31
00:01:41.010 --> 00:01:42.393
as you learned before.

32
00:01:43.320 --> 00:01:47.730
And now in a reducer where we don't just wanna return

33
00:01:47.730 --> 00:01:50.190
the state that we already have,

34
00:01:50.190 --> 00:01:54.390
you can accept a second argument in this reducer.

35
00:01:54.390 --> 00:01:57.960
And that second argument simply is the action

36
00:01:57.960 --> 00:02:00.090
that wast has patched.

37
00:02:00.090 --> 00:02:04.098
Now in theory, a reducer can handle any action dispatched

38
00:02:04.098 --> 00:02:06.930
anywhere in the application.

39
00:02:06.930 --> 00:02:08.310
Of course, in this application

40
00:02:08.310 --> 00:02:10.590
we only have one action thus far.

41
00:02:10.590 --> 00:02:12.780
But this could change over time.

42
00:02:12.780 --> 00:02:15.720
So therefore to make TypeScript happy for now,

43
00:02:15.720 --> 00:02:18.570
I'll simply set the type of action to any,

44
00:02:18.570 --> 00:02:20.730
though I will change this a little bit later.

45
00:02:20.730 --> 00:02:23.220
I'm just doing this right now to make our life a bit easier

46
00:02:23.220 --> 00:02:24.870
for the moment.

47
00:02:24.870 --> 00:02:26.400
Now inside of the reducer,

48
00:02:26.400 --> 00:02:28.500
we now wanna update the state

49
00:02:28.500 --> 00:02:31.110
depending on which action was dispatched.

50
00:02:31.110 --> 00:02:33.306
And if it's an action about which we don't care

51
00:02:33.306 --> 00:02:38.306
in this counter reducer, let's say a user login action,

52
00:02:38.460 --> 00:02:40.920
which has no impact on this reducer,

53
00:02:40.920 --> 00:02:44.790
we wanna return the unchanged state instead.

54
00:02:44.790 --> 00:02:46.680
And keep in mind that state here

55
00:02:46.680 --> 00:02:49.650
really only means this counter state here

56
00:02:49.650 --> 00:02:52.440
for this slice of the overall store.

57
00:02:52.440 --> 00:02:55.020
Keep in mind that the overall store

58
00:02:55.020 --> 00:02:58.770
is built by assigning reducers to keys.

59
00:02:58.770 --> 00:03:00.300
And then it's the combination

60
00:03:00.300 --> 00:03:02.130
of all these different reducers

61
00:03:02.130 --> 00:03:03.930
that makes up the overall store.

62
00:03:03.930 --> 00:03:07.380
But every reducer just handles its slice

63
00:03:07.380 --> 00:03:08.820
of the overall store,

64
00:03:08.820 --> 00:03:12.000
and it's the state of this slice that's managed

65
00:03:12.000 --> 00:03:14.830
by this counterReducer here, for example.

66
00:03:15.900 --> 00:03:17.610
So therefore, here inside the reducer,

67
00:03:17.610 --> 00:03:20.520
we wanna take a look at the action that was dispatched

68
00:03:20.520 --> 00:03:25.440
and then determine if and how we want to handle this action.

69
00:03:25.440 --> 00:03:28.260
And how can we take a look at the action?

70
00:03:28.260 --> 00:03:30.870
Well, for example, with an if statement.

71
00:03:30.870 --> 00:03:34.710
We could check if action.type.

72
00:03:34.710 --> 00:03:38.730
And keep in mind that actions created with createAction

73
00:03:38.730 --> 00:03:41.190
in the end will have such a type.

74
00:03:41.190 --> 00:03:43.200
Increment is a function

75
00:03:43.200 --> 00:03:47.253
which when executed gives you an object that has a type key.

76
00:03:48.213 --> 00:03:50.550
So we can take a look at that type

77
00:03:50.550 --> 00:03:52.980
of that dispatched action object

78
00:03:52.980 --> 00:03:55.500
and we can check if the type here, for example,

79
00:03:55.500 --> 00:03:58.530
is equal to Counter Increment.

80
00:03:58.530 --> 00:04:01.320
So to this identifier, because this here

81
00:04:01.320 --> 00:04:04.320
will be the type of the action.

82
00:04:04.320 --> 00:04:07.230
The type of this action object.

83
00:04:07.230 --> 00:04:10.710
So this type here will be counter increment.

84
00:04:10.710 --> 00:04:13.310
You can also see this here in the preview in my IDE.

85
00:04:14.730 --> 00:04:16.110
So therefore, we wanna check

86
00:04:16.110 --> 00:04:20.280
whether the type is counter increment

87
00:04:20.280 --> 00:04:23.870
and we'll refactor this code to reduce the danger

88
00:04:23.870 --> 00:04:26.430
of having a typo in here, for example,

89
00:04:26.430 --> 00:04:27.630
in a couple of seconds.

90
00:04:27.630 --> 00:04:30.330
But for the moment, that's what it is.

91
00:04:30.330 --> 00:04:32.010
And then in here we know

92
00:04:32.010 --> 00:04:34.560
that we don't wanna return the unchanged state,

93
00:04:34.560 --> 00:04:39.360
but instead here we wanna return the state plus one

94
00:04:39.360 --> 00:04:41.760
so the incremented counter.

95
00:04:41.760 --> 00:04:43.560
And that's in the end what we're doing here.

96
00:04:43.560 --> 00:04:45.480
Though it should not be plus one of course,

97
00:04:45.480 --> 00:04:48.240
but instead action.value

98
00:04:48.240 --> 00:04:51.510
because our action can carry a value,

99
00:04:51.510 --> 00:04:53.610
can carry the value

100
00:04:53.610 --> 00:04:55.470
by which the counter should be incremented.

101
00:04:55.470 --> 00:04:58.890
And therefore, if the action is counter increment,

102
00:04:58.890 --> 00:05:01.410
the new state that should be produced

103
00:05:01.410 --> 00:05:04.410
by this counterReducer should be the old state

104
00:05:04.410 --> 00:05:08.763
plus the value that's included in the dispatched action.

105
00:05:09.720 --> 00:05:12.840
On the other hand, if it's some unknown action type

106
00:05:12.840 --> 00:05:15.600
or an action type about which we simply don't care

107
00:05:15.600 --> 00:05:19.830
in this reducer, I returned the unchanged state.

108
00:05:19.830 --> 00:05:23.100
And again, the state here is really just this slice

109
00:05:23.100 --> 00:05:25.923
of the overall store, this counter state here.

110
00:05:27.000 --> 00:05:29.970
And that's how we could build the counterReducer

111
00:05:29.970 --> 00:05:32.670
without using createReducer.

112
00:05:32.670 --> 00:05:37.330
If I restart this app after saving everything

113
00:05:38.250 --> 00:05:41.250
and I then visit local host 4200,

114
00:05:41.250 --> 00:05:44.433
you see that the Increment button still works fine.

115
00:05:45.780 --> 00:05:48.630
However, this of course is not everything I wanna do here.

116
00:05:48.630 --> 00:05:51.090
Instead, I mentioned that I also wanna show you

117
00:05:51.090 --> 00:05:53.460
how you can avoid createAction.

118
00:05:53.460 --> 00:05:56.370
And we'll then also come back to this code here

119
00:05:56.370 --> 00:05:57.690
and improve it a little bit,

120
00:05:57.690 --> 00:05:59.883
but let's start with the action here.


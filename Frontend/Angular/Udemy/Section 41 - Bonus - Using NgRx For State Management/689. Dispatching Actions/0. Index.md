# 689. Dispatching Actions

> Duração: `4min`

Sem Recursos

WEBVTT

1
00:00:02.250 --> 00:00:03.083
<v Maximilian>And therefore,</v>

2
00:00:03.083 --> 00:00:04.620
there's just one missing piece.

3
00:00:04.620 --> 00:00:08.010
We must make sure that this action can occur.

4
00:00:08.010 --> 00:00:09.270
And in this app here,

5
00:00:09.270 --> 00:00:12.123
that happens in the Counter-controls Component.

6
00:00:12.990 --> 00:00:17.010
In there, I have the increment and decrement functions,

7
00:00:17.010 --> 00:00:20.340
and at the moment, I'm using my old counterService here.

8
00:00:20.340 --> 00:00:22.020
Well, that's not needed anymore.

9
00:00:22.020 --> 00:00:25.260
Instead, you should get rid of this code that was in there

10
00:00:25.260 --> 00:00:28.860
and just keep the empty increment and decrement functions.

11
00:00:28.860 --> 00:00:32.220
And get rid of this counter service import.

12
00:00:32.220 --> 00:00:35.130
And you can now even get rid of the counter service file

13
00:00:35.130 --> 00:00:36.873
because we don't need it anymore.

14
00:00:37.830 --> 00:00:40.560
And instead, in the Counter-controls Component,

15
00:00:40.560 --> 00:00:43.560
we now should also inject the store here,

16
00:00:43.560 --> 00:00:45.750
the NgRx store.

17
00:00:45.750 --> 00:00:48.660
So with help of this type that's imported

18
00:00:48.660 --> 00:00:51.423
from ngrx/store.

19
00:00:52.770 --> 00:00:54.960
And then here in increment,

20
00:00:54.960 --> 00:00:58.410
you can use this injected store object

21
00:00:58.410 --> 00:01:01.950
to call the built-in dispatch method.

22
00:01:01.950 --> 00:01:05.310
So before we use select for selecting data,

23
00:01:05.310 --> 00:01:10.310
now we're using dispatch to dispatch an action.

24
00:01:10.620 --> 00:01:13.500
And now, you just need the identifier of the action

25
00:01:13.500 --> 00:01:14.670
that should be imported.

26
00:01:14.670 --> 00:01:18.330
And here in my case, that's this increment action.

27
00:01:18.330 --> 00:01:23.223
Hence, I'll import increment from my counterActions file.

28
00:01:24.060 --> 00:01:27.483
And then, you must execute this like a function.

29
00:01:28.650 --> 00:01:32.880
So in the end, the thing that is returned by createAction,

30
00:01:32.880 --> 00:01:35.340
is a function increment here.

31
00:01:35.340 --> 00:01:37.920
The increment we're exporting in the end

32
00:01:37.920 --> 00:01:41.280
under the hood is a function that can be executed.

33
00:01:41.280 --> 00:01:44.433
And it must be executed when dispatching.

34
00:01:45.720 --> 00:01:50.610
It's not executed when adding adhere to on in the Reducer.

35
00:01:50.610 --> 00:01:53.310
There we instead just point at it,

36
00:01:53.310 --> 00:01:56.103
but it is executed when we dispatch.

37
00:01:56.940 --> 00:01:59.730
And that's how such an action can be dispatched.

38
00:01:59.730 --> 00:02:02.370
So in the end, you define an action,

39
00:02:02.370 --> 00:02:04.320
you can dispatch it,

40
00:02:04.320 --> 00:02:07.500
and you listen to it and define what should happen

41
00:02:07.500 --> 00:02:10.233
to the state when that action occurs.

42
00:02:11.280 --> 00:02:13.590
You can also add data to actions

43
00:02:13.590 --> 00:02:15.690
but I'll get back to this in a second.

44
00:02:15.690 --> 00:02:18.660
For the moment, let's just save it like this.

45
00:02:18.660 --> 00:02:21.420
And now, if I run NG serve again,

46
00:02:21.420 --> 00:02:24.120
you see that if I reload and I click increment,

47
00:02:24.120 --> 00:02:26.970
indeed, this counter changes here.

48
00:02:26.970 --> 00:02:28.500
And it changes automatically

49
00:02:28.500 --> 00:02:30.900
because we're listening to this observable

50
00:02:30.900 --> 00:02:32.580
with help of the async pipe.

51
00:02:32.580 --> 00:02:34.470
And that pipe got some work to do

52
00:02:34.470 --> 00:02:37.560
because we of course, are dispatching this action,

53
00:02:37.560 --> 00:02:41.163
which is changing the counter with help of the Reducer.

54
00:02:42.000 --> 00:02:43.950
And the code is exactly the same,

55
00:02:43.950 --> 00:02:46.590
no matter if you're in a Standalone Component app

56
00:02:46.590 --> 00:02:49.320
or in an app that uses NG modules.

57
00:02:49.320 --> 00:02:53.850
Either way, you can copy and paste your Reducer code,

58
00:02:53.850 --> 00:02:56.223
into this counter reducer file.

59
00:02:57.270 --> 00:03:02.270
Copy the counter actions TS file into the store folder.

60
00:03:02.790 --> 00:03:05.580
Delete this counter service.

61
00:03:05.580 --> 00:03:08.340
And in the Counter-control Component,

62
00:03:08.340 --> 00:03:12.150
you therefore inject the store,

63
00:03:12.150 --> 00:03:14.253
also here,

64
00:03:15.570 --> 00:03:17.130
like this.

65
00:03:17.130 --> 00:03:18.480
And you just have to make sure

66
00:03:18.480 --> 00:03:20.820
that store is imported from NgRx

67
00:03:20.820 --> 00:03:23.070
and increment this increment action

68
00:03:23.070 --> 00:03:24.990
is imported from the actions file

69
00:03:24.990 --> 00:03:28.500
and the service is then not needed anymore.

70
00:03:28.500 --> 00:03:30.540
So the code is exactly the same

71
00:03:30.540 --> 00:03:32.850
no matter if you're building the application

72
00:03:32.850 --> 00:03:36.990
with Standalone Components or with the Angular modules.

73
00:03:36.990 --> 00:03:39.843
It always works in exactly the same way.


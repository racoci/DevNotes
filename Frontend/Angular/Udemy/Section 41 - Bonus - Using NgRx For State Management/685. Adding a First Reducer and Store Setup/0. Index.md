# 685. Adding a First Reducer & Store Setup

> Duração: `9min`

## Recursos
- 03-added-first-reducer.zip
- 03-added-first-reducer-standalone.zip

WEBVTT

1
00:00:02.130 --> 00:00:03.994
<v Instructor>So we added NgRx,</v>

2
00:00:03.994 --> 00:00:05.430
and therefore now it's of course time

3
00:00:05.430 --> 00:00:08.460
to make sure that we also have some data in that Store,

4
00:00:08.460 --> 00:00:11.070
some data that can be used in our Components.

5
00:00:11.070 --> 00:00:14.310
For example, here in the counter-output-component,

6
00:00:14.310 --> 00:00:16.920
I wanna read data from that Store.

7
00:00:16.920 --> 00:00:19.890
I wanna get the current counter value from that Store

8
00:00:19.890 --> 00:00:22.470
so that I can then output it on the screen

9
00:00:22.470 --> 00:00:24.870
with help of this component here.

10
00:00:24.870 --> 00:00:29.190
Now, to get data into the Store, we need a Reducer.

11
00:00:29.190 --> 00:00:33.420
Because ultimately in this NgRx architecture here,

12
00:00:33.420 --> 00:00:38.100
Reducers are the things that change the data in the Store.

13
00:00:38.100 --> 00:00:41.280
So if we just wanna set up some initial data for now,

14
00:00:41.280 --> 00:00:43.500
we still need a Reducer

15
00:00:43.500 --> 00:00:46.800
because it's that Reducer that sets up the initial value

16
00:00:46.800 --> 00:00:51.090
and then potentially changes it over time.

17
00:00:51.090 --> 00:00:53.850
So to get some data into our Store,

18
00:00:53.850 --> 00:00:58.230
or to also change that data later, we need a Reducer,

19
00:00:58.230 --> 00:01:01.140
and that's therefore what we're going to start with now.

20
00:01:01.140 --> 00:01:03.390
For that, in this application,

21
00:01:03.390 --> 00:01:07.080
here in my app folder I'll add a new folder,

22
00:01:07.080 --> 00:01:11.070
which I'll name Store or Counter Store.

23
00:01:11.070 --> 00:01:12.270
This name is up to you,

24
00:01:12.270 --> 00:01:16.140
but this will be the folder where I wanna store some

25
00:01:16.140 --> 00:01:19.170
NgRx specific files.

26
00:01:19.170 --> 00:01:22.740
For example, the file that will define my Reducers.

27
00:01:22.740 --> 00:01:26.850
And I will Store those files in a folder called Store

28
00:01:26.850 --> 00:01:31.443
because NgRx is all about having that global data Store.

29
00:01:32.310 --> 00:01:34.710
Now, even though it's just one Store,

30
00:01:34.710 --> 00:01:37.200
you could have different Reducer files

31
00:01:37.200 --> 00:01:39.570
for different parts of your application,

32
00:01:39.570 --> 00:01:41.760
but you will see this later.

33
00:01:41.760 --> 00:01:44.250
For the moment, it's this one Store folder

34
00:01:44.250 --> 00:01:47.160
in this app folder, which I'm creating here.

35
00:01:47.160 --> 00:01:48.600
And in that folder

36
00:01:48.600 --> 00:01:53.600
I'll now add a Counter.Reducer.ts file.

37
00:01:53.790 --> 00:01:57.960
And my goal now is to add the Reducer that is responsible

38
00:01:57.960 --> 00:02:00.690
for managing the data that belongs to

39
00:02:00.690 --> 00:02:04.623
this counterpart of this app in this file here.

40
00:02:05.730 --> 00:02:09.150
For that, in the Counter.Reducer.ts file,

41
00:02:09.150 --> 00:02:12.600
I'll start by creating a new constant,

42
00:02:12.600 --> 00:02:16.470
a new variable in the end that will never change though,

43
00:02:16.470 --> 00:02:18.600
hence I'll make it a constant,

44
00:02:18.600 --> 00:02:21.143
which I will name counterReducer.

45
00:02:22.530 --> 00:02:23.790
Now the name is up to you,

46
00:02:23.790 --> 00:02:26.310
but this name here makes a lot of sense

47
00:02:26.310 --> 00:02:28.740
because in the end it will be a Reducer

48
00:02:28.740 --> 00:02:32.520
that is responsible for managing my counter data.

49
00:02:32.520 --> 00:02:35.760
And such a Reducer can now be created

50
00:02:35.760 --> 00:02:37.563
with help of createReducer.

51
00:02:38.640 --> 00:02:41.647
And that is a function that can be imported from

52
00:02:41.647 --> 00:02:44.733
@NgRx/Store.

53
00:02:46.110 --> 00:02:50.220
So that's a function provided by this third party library

54
00:02:50.220 --> 00:02:54.030
that will create such a Reducer thing.

55
00:02:54.030 --> 00:02:55.020
Now, under the hood,

56
00:02:55.020 --> 00:02:58.170
a Reducer, in the end, is just a function

57
00:02:58.170 --> 00:03:01.200
that takes some data as input

58
00:03:01.200 --> 00:03:04.140
and spits out the updated State,

59
00:03:04.140 --> 00:03:07.380
the updated counter State in this case here.

60
00:03:07.380 --> 00:03:10.950
So the updated data that should be Stored in that Store,

61
00:03:10.950 --> 00:03:13.530
that's what a Reducer is under the hood,

62
00:03:13.530 --> 00:03:16.920
but we'll take a closer look under the hood of a Reducer

63
00:03:16.920 --> 00:03:18.963
in the next lecture actually.

64
00:03:20.070 --> 00:03:23.790
So here, we'll just create it with help of createReducer.

65
00:03:23.790 --> 00:03:26.430
And then this createReducer function

66
00:03:26.430 --> 00:03:28.530
needs at least one argument.

67
00:03:28.530 --> 00:03:31.590
And that one argument, which it needs at least,

68
00:03:31.590 --> 00:03:36.590
is the initialState of that piece of the global Store.

69
00:03:37.680 --> 00:03:39.570
And for that, I'll add another constant here,

70
00:03:39.570 --> 00:03:41.100
which I'll name initialState

71
00:03:41.100 --> 00:03:43.020
though this name also is up to you.

72
00:03:43.020 --> 00:03:45.540
It doesn't have to be initialState,

73
00:03:45.540 --> 00:03:47.343
but here I'll name it initialState.

74
00:03:48.600 --> 00:03:50.370
And then here for my counter,

75
00:03:50.370 --> 00:03:53.370
that initialState simply is the number zero.

76
00:03:53.370 --> 00:03:56.190
But, and that's now really important,

77
00:03:56.190 --> 00:04:00.720
when using NgRx, anything can be your State.

78
00:04:00.720 --> 00:04:03.420
It can be a number, as it's the case here.

79
00:04:03.420 --> 00:04:05.310
It could also be some text.

80
00:04:05.310 --> 00:04:07.980
It could be a Boolean value.

81
00:04:07.980 --> 00:04:11.520
it could be an object with the counter value

82
00:04:11.520 --> 00:04:13.620
nested inside of it, for example.

83
00:04:13.620 --> 00:04:16.560
And it could also be an array of course.

84
00:04:16.560 --> 00:04:20.400
So whichever kind of data you need to manage.

85
00:04:20.400 --> 00:04:23.187
In this case for this basic example here,

86
00:04:23.187 --> 00:04:24.840
the counter is a number,

87
00:04:24.840 --> 00:04:27.780
and therefore I'll just Store that number in here.

88
00:04:27.780 --> 00:04:30.120
But later in the section you'll also see

89
00:04:30.120 --> 00:04:33.150
more complex State examples.

90
00:04:33.150 --> 00:04:35.490
So here it's now this initialState value,

91
00:04:35.490 --> 00:04:37.860
which I passed to createReducer,

92
00:04:37.860 --> 00:04:39.960
and therefore of course I could have also just passed

93
00:04:39.960 --> 00:04:41.250
zero in here.

94
00:04:41.250 --> 00:04:44.490
But it is a practice you will see quite a bit

95
00:04:44.490 --> 00:04:47.970
that you define that initialState in a separate variable

96
00:04:47.970 --> 00:04:51.180
or constant simply to make it a bit easier

97
00:04:51.180 --> 00:04:54.000
to quickly see what your initialState is

98
00:04:54.000 --> 00:04:56.760
if we take a look at this file.

99
00:04:56.760 --> 00:04:59.100
Of course, at the moment this file is pretty empty,

100
00:04:59.100 --> 00:05:02.730
but the more complex your State and your Reducer gets,

101
00:05:02.730 --> 00:05:04.770
the more logic might be added here.

102
00:05:04.770 --> 00:05:08.220
And being able to then quickly see the initialState

103
00:05:08.220 --> 00:05:10.800
can therefore be useful.

104
00:05:10.800 --> 00:05:14.400
And with that, we now already actually got

105
00:05:14.400 --> 00:05:17.790
everything we need to set up this Reducer.

106
00:05:17.790 --> 00:05:21.330
It's not too useful yet because it doesn't contain

107
00:05:21.330 --> 00:05:23.580
any logic for changing that State,

108
00:05:23.580 --> 00:05:25.710
but it has an initialState,

109
00:05:25.710 --> 00:05:30.710
and therefore we can now connect this Reducer to this Store

110
00:05:31.680 --> 00:05:34.230
that's set up in the app module here

111
00:05:34.230 --> 00:05:36.000
in this module based app

112
00:05:36.000 --> 00:05:39.870
to make that data available in this application.

113
00:05:39.870 --> 00:05:42.540
And of course, I'll also show you how to do this

114
00:05:42.540 --> 00:05:45.150
in a standalone component app in a second.

115
00:05:45.150 --> 00:05:48.600
The Reducer code is always the same though.

116
00:05:48.600 --> 00:05:51.510
So here we should then export this Reducer

117
00:05:51.510 --> 00:05:54.450
to make it available outside of this file.

118
00:05:54.450 --> 00:05:58.830
And now, when using Ng modules, what you have to do is here

119
00:05:58.830 --> 00:06:01.230
in this Ng module based app,

120
00:06:01.230 --> 00:06:04.890
in this place where the Store is in the end created

121
00:06:04.890 --> 00:06:07.590
with help of StoreModule.forRoot,

122
00:06:07.590 --> 00:06:11.400
you should pass an object to forRoot.

123
00:06:11.400 --> 00:06:15.120
And then in that object you can pick any key of your choice.

124
00:06:15.120 --> 00:06:18.750
For example, counter to describe the kind of

125
00:06:18.750 --> 00:06:22.110
data piece you wanna add to that Store.

126
00:06:22.110 --> 00:06:27.110
And then as a value for that key, you use your Reducer.

127
00:06:27.480 --> 00:06:30.510
In my case here, this counterReducer,

128
00:06:30.510 --> 00:06:33.240
which of course the offer also must be imported.

129
00:06:33.240 --> 00:06:36.420
And then it's used as a value for this key.

130
00:06:36.420 --> 00:06:38.850
And if you had multiple Reducers

131
00:06:38.850 --> 00:06:41.430
for different parts of your application

132
00:06:41.430 --> 00:06:43.950
and different features of your application,

133
00:06:43.950 --> 00:06:47.760
you could simply add them here as key value pairs.

134
00:06:47.760 --> 00:06:48.960
If we had an authReducer

135
00:06:50.026 --> 00:06:53.400
that manages the current authentication status of a user,

136
00:06:53.400 --> 00:06:57.720
you could store it under an auth key in this object.

137
00:06:57.720 --> 00:06:59.010
Now we don't have that here,

138
00:06:59.010 --> 00:07:01.590
but that is how you could build one Store

139
00:07:01.590 --> 00:07:06.090
consisting of multiple Reducers that manage different pieces

140
00:07:06.090 --> 00:07:09.150
of the overall application data.

141
00:07:09.150 --> 00:07:11.536
Now here, it's just a counterReducer,

142
00:07:11.536 --> 00:07:14.400
but that of course is an important first step.

143
00:07:14.400 --> 00:07:15.960
And it's basically the same

144
00:07:15.960 --> 00:07:18.480
when using Standalone Components.

145
00:07:18.480 --> 00:07:23.480
There in main.ts, where provideStore was added,

146
00:07:23.820 --> 00:07:26.973
you now can pass an object to provideStore,

147
00:07:27.840 --> 00:07:30.180
then choose any key of your choice.

148
00:07:30.180 --> 00:07:32.490
For example, again, counter.

149
00:07:32.490 --> 00:07:36.183
And then assign your Reducer as a value for that key.

150
00:07:37.680 --> 00:07:41.760
So here, I haven't added my Store folder yet,

151
00:07:41.760 --> 00:07:45.150
so I'll copy that Store folder from the module based app

152
00:07:45.150 --> 00:07:48.060
here into the app folder of the Standalone Component

153
00:07:48.060 --> 00:07:52.080
based app so that I have my counterReducer there as well.

154
00:07:52.080 --> 00:07:56.910
And now in main.ts, I can assign this counterReducer,

155
00:07:56.910 --> 00:08:00.993
which of course must be imported as a value to counter here.

156
00:08:02.310 --> 00:08:05.070
And with that, we added to this global Store.

157
00:08:05.070 --> 00:08:07.200
And again, just as explained before,

158
00:08:07.200 --> 00:08:11.370
for the module based app, if you now had multiple Reducers

159
00:08:11.370 --> 00:08:13.110
for different parts of the app,

160
00:08:13.110 --> 00:08:15.630
you could of course all add them here

161
00:08:15.630 --> 00:08:18.480
to this provideStore function.

162
00:08:18.480 --> 00:08:22.110
But of course here I only have that one Reducer.

163
00:08:22.110 --> 00:08:24.990
And that's how you set up a Reducer

164
00:08:24.990 --> 00:08:26.970
and how you then register it

165
00:08:26.970 --> 00:08:31.140
both for an app that uses Standalone Components

166
00:08:31.140 --> 00:08:33.213
and an app that uses modules.


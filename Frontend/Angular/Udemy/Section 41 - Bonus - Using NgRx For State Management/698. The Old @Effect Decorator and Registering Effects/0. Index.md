# 698. The Old @Effect Decorator & Registering Effects

> Duração: `4min`

Sem Recursos

WEBVTT

1
00:00:02.160 --> 00:00:03.960
<v Maximilian>Now, as a little extra note here,</v>

2
00:00:03.960 --> 00:00:05.040
I also wanna mention

3
00:00:05.040 --> 00:00:09.600
that in the past when working with older versions of NgRx,

4
00:00:09.600 --> 00:00:13.140
the createEffect function here did not exist.

5
00:00:13.140 --> 00:00:15.960
And instead of registering an effect like this,

6
00:00:15.960 --> 00:00:19.860
you would've just registered this pipeline

7
00:00:19.860 --> 00:00:22.410
as a value here in a property

8
00:00:22.410 --> 00:00:27.410
and you would've decorated it with the @Effect decorator.

9
00:00:27.660 --> 00:00:31.740
And this decorator would've been imported from NgRx Effect

10
00:00:31.740 --> 00:00:36.740
but it's not supported in recent NgRx versions anymore.

11
00:00:36.990 --> 00:00:38.970
In old versions, it was supported

12
00:00:38.970 --> 00:00:42.930
and you would've passed dispatch: false wrapped in an object

13
00:00:42.930 --> 00:00:46.380
as a value to this @Effect decorator.

14
00:00:46.380 --> 00:00:48.180
So this is how you would've written this

15
00:00:48.180 --> 00:00:51.420
in older versions, older NgRx versions.

16
00:00:51.420 --> 00:00:53.850
In more recent versions as mentioned,

17
00:00:53.850 --> 00:00:56.610
the Effect decorator is not supported anymore

18
00:00:56.610 --> 00:01:00.450
and therefore, instead you wrap this pipeline

19
00:01:00.450 --> 00:01:02.460
into a function

20
00:01:02.460 --> 00:01:07.140
and pass that function to the createEffect function

21
00:01:07.140 --> 00:01:09.960
and you then simply pass this configuration object

22
00:01:09.960 --> 00:01:12.033
as a second value to createEffect.

23
00:01:13.320 --> 00:01:16.290
So that's just something you should also be aware of.

24
00:01:16.290 --> 00:01:19.440
But with that, this effect is now registered.

25
00:01:19.440 --> 00:01:24.150
And now to register it with NgRx, you should go

26
00:01:24.150 --> 00:01:28.020
to your main.ts file when using standalone components

27
00:01:28.020 --> 00:01:33.020
or the app module file when using modules.

28
00:01:33.360 --> 00:01:37.020
And then there you have this provideEffects function

29
00:01:37.020 --> 00:01:39.577
or EffectsModule.forRoot.

30
00:01:40.950 --> 00:01:44.790
And you would now simply pass an array to provideEffects

31
00:01:44.790 --> 00:01:48.420
or to EffectsModule.forRoot

32
00:01:48.420 --> 00:01:53.010
and pass your Effect classes that you have to this array.

33
00:01:53.010 --> 00:01:57.510
So in this case, the CounterEffects class.

34
00:01:57.510 --> 00:01:59.850
It is imported here and then passed

35
00:01:59.850 --> 00:02:02.853
as a value in this array to provideEffects.

36
00:02:04.350 --> 00:02:07.560
And again, that's exactly the same if you're using modules.

37
00:02:07.560 --> 00:02:12.060
So therefore here, I'll also copy the counter.effects file

38
00:02:12.060 --> 00:02:13.830
from my standalone component app

39
00:02:13.830 --> 00:02:17.253
into the store folder of the module-based app.

40
00:02:18.240 --> 00:02:21.270
And then here I add CounterEffects

41
00:02:22.638 --> 00:02:24.540
to EffectsModule.forRoot.

42
00:02:24.540 --> 00:02:26.853
And also add this import here, of course.

43
00:02:28.590 --> 00:02:31.140
Now with that, there's just one additional thing

44
00:02:31.140 --> 00:02:33.570
you should do in both applications.

45
00:02:33.570 --> 00:02:36.810
This CounterEffects class should be decorated

46
00:02:36.810 --> 00:02:40.200
with the @Injectable decorator provided

47
00:02:40.200 --> 00:02:41.760
by Angular to make sure

48
00:02:41.760 --> 00:02:44.940
that it can successfully be injected.

49
00:02:44.940 --> 00:02:48.060
So you should add this here to CounterEffects

50
00:02:48.060 --> 00:02:49.860
in the module-based application

51
00:02:49.860 --> 00:02:53.550
and also when using standalone components.

52
00:02:53.550 --> 00:02:54.780
And of course, you must make sure

53
00:02:54.780 --> 00:02:57.993
that you also add the import from angular/core.

54
00:02:59.730 --> 00:03:01.080
With that, however,

55
00:03:01.080 --> 00:03:03.720
you're able to serve this application no matter

56
00:03:03.720 --> 00:03:07.290
if you're using standalone components or modules.

57
00:03:07.290 --> 00:03:09.360
And you can, therefore, then see your counters

58
00:03:09.360 --> 00:03:13.620
and decrement and increment them, and you will see that now

59
00:03:13.620 --> 00:03:15.870
if you open your console,

60
00:03:15.870 --> 00:03:20.870
the action object gets locked there because in my effect,

61
00:03:21.480 --> 00:03:24.720
I added this console.log line here.

62
00:03:24.720 --> 00:03:28.350
And you will also see that if you go to application,

63
00:03:28.350 --> 00:03:31.260
to your local storage, you got this count value here,

64
00:03:31.260 --> 00:03:34.620
which is not the latest counter value

65
00:03:34.620 --> 00:03:37.110
but only the value by which it was changed.

66
00:03:37.110 --> 00:03:39.210
Something we will improve soon.

67
00:03:39.210 --> 00:03:41.523
But you see that this also works.


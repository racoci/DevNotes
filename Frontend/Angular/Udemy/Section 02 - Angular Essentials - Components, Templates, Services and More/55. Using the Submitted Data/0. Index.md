# 55. Using the Submitted Data

> Duração: `7min`

Sem Recursos

WEBVTT

1
00:00:00.360 --> 00:00:02.670
<v Maximilian>Now since we have that two-way binding,</v>

2
00:00:02.670 --> 00:00:05.808
which populates, enteredTitle, enteredSummary,

3
00:00:05.808 --> 00:00:10.410
and enteredDate, we can use these properties in onSubmit

4
00:00:10.410 --> 00:00:14.793
to construct a new task or do whatever we wanna do.

5
00:00:16.200 --> 00:00:21.200
And what I wanna do here is let the TasksComponent,

6
00:00:21.270 --> 00:00:23.280
which manages all my tasks,

7
00:00:23.280 --> 00:00:27.840
know about that new task data that has been submitted,

8
00:00:27.840 --> 00:00:32.010
so that we can add a new task there to this tasks array,

9
00:00:32.010 --> 00:00:34.620
and so that we can close the dialogue

10
00:00:34.620 --> 00:00:38.400
by setting this.isAddingTask to false.

11
00:00:38.400 --> 00:00:40.440
So in the NewTaskComponent,

12
00:00:40.440 --> 00:00:43.830
we wanna emit another new event here,

13
00:00:43.830 --> 00:00:47.550
the add event, for example.

14
00:00:47.550 --> 00:00:49.440
As always, this name is up to you,

15
00:00:49.440 --> 00:00:53.190
but it should describe the event that's occurring.

16
00:00:53.190 --> 00:00:55.860
And we create a new EventEmitter object for that,

17
00:00:55.860 --> 00:01:00.090
but this time we will be submitting some data.

18
00:01:00.090 --> 00:01:04.350
And the data I wanna submit here is an object,

19
00:01:04.350 --> 00:01:07.680
since I wanna submit the title, summary, and date.

20
00:01:07.680 --> 00:01:09.270
So it should be an object

21
00:01:09.270 --> 00:01:13.203
that has a title key which will hold a value of type string,

22
00:01:14.100 --> 00:01:18.090
a summary key which will hold a value of type string,

23
00:01:18.090 --> 00:01:22.293
and a date key which will hold a value of type string.

24
00:01:24.750 --> 00:01:28.560
And then here in onSubmit, we use this add property

25
00:01:28.560 --> 00:01:33.560
to emit a new event, and we pass our object to emit.

26
00:01:34.380 --> 00:01:38.523
And that object now must have a title property,

27
00:01:39.660 --> 00:01:41.940
because of this generic type we added here,

28
00:01:41.940 --> 00:01:44.190
and that is why we are adding it,

29
00:01:44.190 --> 00:01:47.913
so that we do add the proper type down here when we emit.

30
00:01:49.110 --> 00:01:51.607
And the title is of course this.enteredTitle,

31
00:01:53.160 --> 00:01:56.013
the summary is this.enteredSummary,

32
00:01:56.880 --> 00:01:59.553
and the date is this.enteredDate,

33
00:02:02.220 --> 00:02:04.950
like this, that's the finished code here

34
00:02:04.950 --> 00:02:07.323
in the NewTaskComponent class.

35
00:02:08.490 --> 00:02:12.150
Now we can go to the tasks.component template,

36
00:02:12.150 --> 00:02:15.750
and there on this NewTaskComponent instance,

37
00:02:15.750 --> 00:02:17.673
we can listen to this add event.

38
00:02:18.840 --> 00:02:23.840
And then trigger a new method in the TasksComponent class,

39
00:02:26.700 --> 00:02:30.813
which we can call onAddTask, for example.

40
00:02:32.070 --> 00:02:35.820
And here of course I expect to get my taskData,

41
00:02:35.820 --> 00:02:37.920
which again should be an object

42
00:02:37.920 --> 00:02:40.200
that has that shape I described

43
00:02:40.200 --> 00:02:44.013
in my new-task.component.ts file.

44
00:02:44.910 --> 00:02:47.520
And now since I need the same type definition

45
00:02:47.520 --> 00:02:51.723
in multiple files, I actually wanna outsource it again.

46
00:02:52.950 --> 00:02:57.950
And we could outsource it here in a new-task.model.ts file

47
00:02:58.380 --> 00:03:03.240
or we could merge it into the existing task.model.ts file,

48
00:03:03.240 --> 00:03:04.290
that is up to you.

49
00:03:04.290 --> 00:03:07.413
And I'll go for this approach where I merge it.

50
00:03:08.370 --> 00:03:11.250
So here I export another interface,

51
00:03:11.250 --> 00:03:16.050
I'll name it NewTaskData, that sounds like a fitting name.

52
00:03:16.050 --> 00:03:20.463
And then I have my object definition here.

53
00:03:21.780 --> 00:03:25.470
Now in the new-task.component TypeScript file, instead

54
00:03:25.470 --> 00:03:28.800
of defining this object type inline like this,

55
00:03:28.800 --> 00:03:33.633
I'll use this NewTaskData type,

56
00:03:34.830 --> 00:03:38.640
which must be imported from this task.model file.

57
00:03:38.640 --> 00:03:41.463
And again, we can add this type annotation here.

58
00:03:44.550 --> 00:03:49.550
And we can now do the same in the tasks.component file.

59
00:03:49.680 --> 00:03:54.140
There, the taskData we receive in this method should be

60
00:03:54.140 --> 00:03:58.710
of that shape, so it should be that NewTaskData type.

61
00:03:58.710 --> 00:04:02.460
And therefore of course, we also must import this type here

62
00:04:02.460 --> 00:04:05.850
in this component file.

63
00:04:05.850 --> 00:04:08.223
We can also add the type annotation here.

64
00:04:11.040 --> 00:04:13.920
With that we know that we'll get such a task here,

65
00:04:13.920 --> 00:04:18.120
and therefore we can then edit our tasks array

66
00:04:18.120 --> 00:04:20.673
and push a new task onto it.

67
00:04:22.140 --> 00:04:27.140
Now this tasks array holds tasks that have this shape,

68
00:04:27.540 --> 00:04:30.333
an id, and then title, summary, dueDate, and a userId.

69
00:04:33.450 --> 00:04:34.283
So therefore,

70
00:04:34.283 --> 00:04:37.560
the new task we wanna add here should have that same shape.

71
00:04:37.560 --> 00:04:41.070
And actually TypeScript thankfully forces us

72
00:04:41.070 --> 00:04:42.453
to have that shape here.

73
00:04:43.830 --> 00:04:47.640
So I'll add an id property here,

74
00:04:47.640 --> 00:04:50.520
and I wanna generate a new id here.

75
00:04:50.520 --> 00:04:55.230
So for simplicity reasons, I'll simply use the current date,

76
00:04:55.230 --> 00:04:57.960
get the time in milliseconds,

77
00:04:57.960 --> 00:05:00.750
and then convert this to a string.

78
00:05:00.750 --> 00:05:03.360
It's not a perfectly unique id.

79
00:05:03.360 --> 00:05:07.200
We could generate two tasks at exactly the same point

80
00:05:07.200 --> 00:05:10.563
of time, but it's definitely good enough for this demo.

81
00:05:12.090 --> 00:05:15.180
And I'll also set the other fields.

82
00:05:15.180 --> 00:05:19.140
The title can be set to taskData.title.

83
00:05:19.140 --> 00:05:22.950
The summary should be set to taskData.summary,

84
00:05:22.950 --> 00:05:26.703
and the dueDate should be set to taskData.date.

85
00:05:27.660 --> 00:05:31.233
But of course then we also need that userId here.

86
00:05:32.340 --> 00:05:37.340
And that userId is thankfully something which we have here,

87
00:05:37.710 --> 00:05:39.243
because of this input.

88
00:05:40.380 --> 00:05:42.510
So we have that userId property

89
00:05:42.510 --> 00:05:45.393
which holds the ID of the currently selected user.

90
00:05:46.980 --> 00:05:51.557
So therefore userId is simply equal to this.userId,

91
00:05:53.700 --> 00:05:57.420
and that should therefore then add a new task.

92
00:05:57.420 --> 00:05:59.850
By the way, if you would want to add it at the beginning

93
00:05:59.850 --> 00:06:02.790
of the array, you could add the unshift method,

94
00:06:02.790 --> 00:06:05.583
which is built into JavaScript, instead of push.

95
00:06:06.960 --> 00:06:11.340
Now with that, we're almost there, but not quite.

96
00:06:11.340 --> 00:06:16.340
We also want to set isAddingTask to false,

97
00:06:17.070 --> 00:06:18.963
so that we close the dialogue.

98
00:06:20.010 --> 00:06:23.943
And in the tasks.component template file,

99
00:06:24.870 --> 00:06:28.980
we of course have to set this add event,

100
00:06:28.980 --> 00:06:31.680
which is emitted by the NewTaskComponent,

101
00:06:31.680 --> 00:06:34.860
to this newly added onAddTask method

102
00:06:34.860 --> 00:06:37.503
and forward that emitted event data.

103
00:06:40.200 --> 00:06:43.740
And with that all done, if we now save everything,

104
00:06:43.740 --> 00:06:45.840
we can give this a try,

105
00:06:45.840 --> 00:06:49.293
and enter some new data,

106
00:06:50.520 --> 00:06:53.910
like this, pick a date,

107
00:06:53.910 --> 00:06:57.090
and if I click Create, the dialog closes,

108
00:06:57.090 --> 00:06:59.670
and my task shows up here,

109
00:06:59.670 --> 00:07:03.660
and only for that user, not for any other user.

110
00:07:03.660 --> 00:07:05.520
So that's working as it should.

111
00:07:05.520 --> 00:07:07.440
We can also complete this task,

112
00:07:07.440 --> 00:07:09.750
and that's all looking good therefore.

113
00:07:09.750 --> 00:07:13.200
And hence we're almost done with this application,

114
00:07:13.200 --> 00:07:14.880
but there still are a couple

115
00:07:14.880 --> 00:07:18.303
of improvements I wanna implement together with you.


# 60. More Service Usage & Alternative Dependency Injection Mechanism

> Duração: `5min`

Sem Recursos

WEBVTT

1
00:00:00.000 --> 00:00:03.420
<v ->[Maximilian Schwarzmüller] So now in order to reuse</v>

2
00:00:03.420 --> 00:00:05.490
our tasks service,

3
00:00:05.490 --> 00:00:07.440
I'll actually start by going

4
00:00:07.440 --> 00:00:09.843
to this new task component here.

5
00:00:11.100 --> 00:00:15.210
And there, it's in this on submit method

6
00:00:15.210 --> 00:00:19.350
where I actually no longer want to emit

7
00:00:19.350 --> 00:00:21.333
the entered task data.

8
00:00:22.350 --> 00:00:26.073
Instead here we also want to use that Service Now.

9
00:00:26.940 --> 00:00:30.000
And we can again inject it by using this constructor

10
00:00:30.000 --> 00:00:32.190
or with help of another feature

11
00:00:32.190 --> 00:00:34.170
that's also offered by Angular.

12
00:00:34.170 --> 00:00:36.960
And it's up to you which one you prefer

13
00:00:36.960 --> 00:00:39.480
because you can also simply add

14
00:00:39.480 --> 00:00:42.750
a private or public property again,

15
00:00:42.750 --> 00:00:46.080
and again, I will name it tasks service.

16
00:00:46.080 --> 00:00:48.240
But now instead of receiving it

17
00:00:48.240 --> 00:00:50.070
in the constructor and so on,

18
00:00:50.070 --> 00:00:53.760
you can initialize it to a value that is created

19
00:00:53.760 --> 00:00:57.450
with help of the inject function,

20
00:00:57.450 --> 00:01:01.770
which must be imported from @Angular core.

21
00:01:01.770 --> 00:01:05.310
So this function must be imported from Angular.

22
00:01:05.310 --> 00:01:08.790
And this inject function does what the name implies,

23
00:01:08.790 --> 00:01:11.460
it injects a dependency

24
00:01:11.460 --> 00:01:15.033
and provides it as a value for this property.

25
00:01:16.170 --> 00:01:20.613
And here it's then this tasks service which we wanna inject.

26
00:01:22.560 --> 00:01:24.360
So therefore you have to import

27
00:01:24.360 --> 00:01:27.180
this tasks service class again.

28
00:01:27.180 --> 00:01:29.640
And then you don't instantiate it here,

29
00:01:29.640 --> 00:01:33.525
but instead you use just the task service class name

30
00:01:33.525 --> 00:01:38.525
as a so-called injection token that's passed to inject.

31
00:01:39.480 --> 00:01:42.600
And again, Angular will then do the heavy lifting

32
00:01:42.600 --> 00:01:43.443
under the hood.

33
00:01:44.970 --> 00:01:46.080
And with this done,

34
00:01:46.080 --> 00:01:50.310
you can then get rid of this code here in onSubmit

35
00:01:50.310 --> 00:01:55.310
and instead use this taskService to call addTask.

36
00:01:56.820 --> 00:02:01.410
And then again, we have to create such a tasks data object

37
00:02:01.410 --> 00:02:05.370
where we have the title, so I'll enter the title

38
00:02:05.370 --> 00:02:09.510
and summary, so the entered summary

39
00:02:09.510 --> 00:02:13.083
and also the date, the entered date.

40
00:02:14.370 --> 00:02:18.930
And in addition, we also need to provide the user ID.

41
00:02:18.930 --> 00:02:20.810
And at the moment we don't have that here

42
00:02:20.810 --> 00:02:23.310
in this new task component.

43
00:02:23.310 --> 00:02:26.700
So therefore we should actually add an input here

44
00:02:26.700 --> 00:02:29.670
imported from @Angular core,

45
00:02:29.670 --> 00:02:34.593
the user ID input, which is actually required,

46
00:02:35.550 --> 00:02:38.283
and of type string like this.

47
00:02:40.200 --> 00:02:42.897
And with that, we have the user ID available

48
00:02:42.897 --> 00:02:47.340
and we can pass it here as a second argument to add task,

49
00:02:47.340 --> 00:02:48.557
this.userID.

50
00:02:50.220 --> 00:02:54.813
So with that, we then use that service to add a new task.

51
00:02:56.370 --> 00:02:57.930
And we provide that service

52
00:02:57.930 --> 00:02:59.790
with help of this inject function,

53
00:02:59.790 --> 00:03:02.160
which is simply an alternative

54
00:03:02.160 --> 00:03:04.500
to this constructor based approach.

55
00:03:04.500 --> 00:03:07.713
And it's up to you which approach you prefer.

56
00:03:09.300 --> 00:03:12.510
Now with that change made, we of course have to make sure

57
00:03:12.510 --> 00:03:16.680
that this user ID is provided to the new task component.

58
00:03:16.680 --> 00:03:20.460
So therefore in the task component template file,

59
00:03:20.460 --> 00:03:23.370
we should set that user ID here

60
00:03:23.370 --> 00:03:26.310
equal to the user ID property,

61
00:03:26.310 --> 00:03:30.063
which is indeed available here in the tasks component.

62
00:03:31.260 --> 00:03:34.680
Now of course, if we use this approach,

63
00:03:34.680 --> 00:03:38.430
we actually no longer emit the add event

64
00:03:38.430 --> 00:03:40.950
and therefore we can get rid of that here

65
00:03:40.950 --> 00:03:42.753
in the new task component.

66
00:03:43.800 --> 00:03:45.570
But since I still want to make sure

67
00:03:45.570 --> 00:03:50.570
that the dialogue gets closed whenever we submit the form,

68
00:03:50.880 --> 00:03:55.470
I'll rename the cancel event here to close

69
00:03:55.470 --> 00:03:58.644
so that we have a more universal name here.

70
00:03:58.644 --> 00:04:01.650
And I'll emit close here.

71
00:04:01.650 --> 00:04:05.331
And I'll also emit this close event here in onSubmit

72
00:04:05.331 --> 00:04:07.863
after submitting the data to the service.

73
00:04:09.720 --> 00:04:14.720
And with this change made back in the tasks component,

74
00:04:14.850 --> 00:04:17.940
we should no longer listen for a cancel event,

75
00:04:17.940 --> 00:04:19.893
but instead for a close event,

76
00:04:20.910 --> 00:04:23.370
and maybe also rename this method here

77
00:04:23.370 --> 00:04:28.203
to onCloseAddTask or something like this.

78
00:04:29.400 --> 00:04:31.830
We should also get rid of this add event

79
00:04:31.830 --> 00:04:33.663
since it no longer exists.

80
00:04:35.130 --> 00:04:40.130
And now as a last step in the tasks component class,

81
00:04:40.650 --> 00:04:43.470
the onCancelAddTask method

82
00:04:43.470 --> 00:04:46.583
should be renamed to onCloseAddTask.

83
00:04:47.760 --> 00:04:51.540
And the on add task method should be removed

84
00:04:51.540 --> 00:04:53.673
because we're no longer triggering it.

85
00:04:54.570 --> 00:04:56.550
But with all those changes made,

86
00:04:56.550 --> 00:04:58.770
if we now go back and reload,

87
00:04:58.770 --> 00:05:00.640
we can still add a new task

88
00:05:06.270 --> 00:05:08.280
and we still close the dialogue

89
00:05:08.280 --> 00:05:10.830
and see the task being added here.

90
00:05:10.830 --> 00:05:13.260
So that all still works as before,

91
00:05:13.260 --> 00:05:15.543
but now with the help of our service.


# 49. More Component Communication: Deleting Tasks

> Duração: `5min`

Sem Recursos

WEBVTT

1
00:00:00.300 --> 00:00:02.430
<v Maximilian>So now as a next step,</v>

2
00:00:02.430 --> 00:00:05.640
I'd like to make this Complete button here work

3
00:00:05.640 --> 00:00:08.880
so that when we click it, the task is removed.

4
00:00:08.880 --> 00:00:11.490
That is what completing a task should mean

5
00:00:11.490 --> 00:00:13.920
in this demo application.

6
00:00:13.920 --> 00:00:18.920
And therefore we have to go to this task component template

7
00:00:19.320 --> 00:00:22.630
because it's in there where we have this Complete button

8
00:00:23.910 --> 00:00:27.100
and we have to add a click listener on it

9
00:00:27.960 --> 00:00:29.490
so that we can find out

10
00:00:29.490 --> 00:00:31.443
whether this button was clicked or not.

11
00:00:32.460 --> 00:00:36.870
And then of course, we want to communicate this information

12
00:00:36.870 --> 00:00:40.440
that this button in this component was clicked

13
00:00:40.440 --> 00:00:42.930
to the tasks component,

14
00:00:42.930 --> 00:00:47.010
which is where we're managing all these tasks.

15
00:00:47.010 --> 00:00:51.810
Hence, in the task component, which manages a single task,

16
00:00:51.810 --> 00:00:54.510
we have to add an output

17
00:00:54.510 --> 00:00:57.520
so that we can emit our own custom event there

18
00:00:58.440 --> 00:01:00.240
with help of the output decorator

19
00:01:00.240 --> 00:01:02.910
that's imported from angular/core.

20
00:01:02.910 --> 00:01:05.700
And then I'll give this property a name of complete.

21
00:01:05.700 --> 00:01:08.520
And the value, as you learned it before,

22
00:01:08.520 --> 00:01:11.520
is a new event emitter,

23
00:01:11.520 --> 00:01:15.390
which must be imported from @angular/core.

24
00:01:15.390 --> 00:01:19.170
Now we can add a method to this task component.

25
00:01:19.170 --> 00:01:22.680
For example, a method called onCompleteTask

26
00:01:22.680 --> 00:01:24.243
or anything like that.

27
00:01:25.080 --> 00:01:29.103
And here we use this complete property to emit a new value.

28
00:01:30.870 --> 00:01:33.960
And now again, we might want to share some information

29
00:01:33.960 --> 00:01:36.030
with the parent component

30
00:01:36.030 --> 00:01:39.963
so we could emit this.task.id here.

31
00:01:41.010 --> 00:01:44.340
Now, just as before with the select event

32
00:01:44.340 --> 00:01:46.470
on the user component,

33
00:01:46.470 --> 00:01:50.580
you should also add this extra type annotation here

34
00:01:50.580 --> 00:01:54.273
on EventEmitter when emitting this complete event.

35
00:01:55.350 --> 00:01:59.880
Here, I'm about to emit such an id, which is of type string.

36
00:01:59.880 --> 00:02:01.770
So therefore we should add string

37
00:02:01.770 --> 00:02:03.603
between angle brackets here.

38
00:02:04.650 --> 00:02:09.000
And with that we got our custom complete output here.

39
00:02:09.000 --> 00:02:12.540
Now we can use that in the parent component

40
00:02:12.540 --> 00:02:14.400
of the task component,

41
00:02:14.400 --> 00:02:18.120
so in the tasks component,

42
00:02:18.120 --> 00:02:22.503
to listen to that event here on the app-task element.

43
00:02:23.730 --> 00:02:27.480
Here, we can now listen to this complete event

44
00:02:27.480 --> 00:02:30.543
and then trigger any method of our choice.

45
00:02:31.410 --> 00:02:34.380
So here I'll simply add such a method then

46
00:02:34.380 --> 00:02:37.290
in the tasks component class,

47
00:02:37.290 --> 00:02:39.443
and I'll name it onCompleteTask.

48
00:02:41.160 --> 00:02:42.510
The name is up to you,

49
00:02:42.510 --> 00:02:45.720
but here I know that I will then get the id of the task

50
00:02:45.720 --> 00:02:48.130
that was completed as an argument

51
00:02:48.990 --> 00:02:51.480
and that it will be of type string.

52
00:02:51.480 --> 00:02:53.703
And we can then later add our code here.

53
00:02:54.960 --> 00:02:57.630
In the tasks component template file,

54
00:02:57.630 --> 00:03:01.380
it's therefore onCompleteTask that should be triggered

55
00:03:01.380 --> 00:03:05.940
and we should forward that emitted data as described,

56
00:03:05.940 --> 00:03:09.090
so therefore we pass $event here,

57
00:03:09.090 --> 00:03:12.990
this special variable that's made available by Angular

58
00:03:12.990 --> 00:03:17.373
that gives us access to the event data that was emitted.

59
00:03:19.170 --> 00:03:21.630
In the task.component.html file,

60
00:03:21.630 --> 00:03:23.940
we can now also complete the code

61
00:03:23.940 --> 00:03:27.480
and bind our click listener on the Complete button

62
00:03:27.480 --> 00:03:30.453
to onCompleteTask in this component,

63
00:03:31.530 --> 00:03:33.840
and in this task component,

64
00:03:33.840 --> 00:03:37.740
onCompleteTask then does not want any input,

65
00:03:37.740 --> 00:03:40.200
so we can simply call it like this

66
00:03:40.200 --> 00:03:42.423
with an empty pair of parentheses here.

67
00:03:43.500 --> 00:03:45.390
Now with that, we're emitting the event.

68
00:03:45.390 --> 00:03:47.820
We're of course not doing anything with it though.

69
00:03:47.820 --> 00:03:50.970
In the tasks component, we got no real code

70
00:03:50.970 --> 00:03:53.463
that would do anything with that id.

71
00:03:54.480 --> 00:03:56.310
And that of course should now change

72
00:03:56.310 --> 00:04:00.750
because the goal now is to update this list of tasks

73
00:04:00.750 --> 00:04:04.323
and to remove the task that was marked as completed.

74
00:04:05.760 --> 00:04:10.140
And this can be achieved by setting this.tasks here

75
00:04:10.140 --> 00:04:14.490
equal to this.tasks.filter,

76
00:04:14.490 --> 00:04:18.780
so to a filtered version of this tasks array.

77
00:04:18.780 --> 00:04:23.520
And this filtered version will be the old tasks array

78
00:04:23.520 --> 00:04:27.600
without that task that has this id.

79
00:04:27.600 --> 00:04:29.700
That's the idea here.

80
00:04:29.700 --> 00:04:32.340
So therefore, filter takes this function

81
00:04:32.340 --> 00:04:37.340
I explained earlier, and we get the individual task here,

82
00:04:37.500 --> 00:04:39.330
and we wanna return true

83
00:04:39.330 --> 00:04:41.880
if the id of the task we're looking at

84
00:04:41.880 --> 00:04:45.483
is not equal to the id we received here.

85
00:04:46.740 --> 00:04:48.840
Because if it is equal,

86
00:04:48.840 --> 00:04:51.330
it is the task that should be removed.

87
00:04:51.330 --> 00:04:54.090
So we wanna return false for that task

88
00:04:54.090 --> 00:04:55.443
so that it's dropped.

89
00:04:56.370 --> 00:05:00.240
And therefore, now with this done, if you go back,

90
00:05:00.240 --> 00:05:04.860
you should be able to select a user, click Complete,

91
00:05:04.860 --> 00:05:06.520
and the task is gone

92
00:05:07.560 --> 00:05:11.370
and the other tasks on the other user are still there.

93
00:05:11.370 --> 00:05:13.800
Though we can of course also complete those

94
00:05:13.800 --> 00:05:16.683
until all tasks are completed.

95
00:05:17.820 --> 00:05:21.600
And that's therefore another major step towards completing

96
00:05:21.600 --> 00:05:23.793
this first demo application.


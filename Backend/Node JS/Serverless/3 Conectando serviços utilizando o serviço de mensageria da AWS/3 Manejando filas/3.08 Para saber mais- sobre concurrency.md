# 3.08 Para saber mais: sobre concurrency

O termo _concurrency_ (ou simultaneidade em tradução livre), é largamente utilizado em programação.

Imagine uma situação onde uma aplicação recebe um grande volume de mensagens que irão interagir com uma função lambda, que por princípio tem a capacidade de escalar automaticamente conforme necessário.

Em projetos Serverless que utilizam SQS, o controle de concurrency serve para evitar que situações como essa possam causar um “estouro” na capacidade de resposta de outras partes da aplicação, como uma API de terceiros ou uma base de dados. Isso é feito controlando o número máximo de instâncias de uma função que podem ser executadas de forma simultânea.

É possível configurar um limite de concurrency em cada função separadamente, e também há um limite para a aplicação. Estabelecer este limite é útil especialmente para:

- Evitar o cenário acima, onde uma função poderia enviar requisições em excesso para outra parte da aplicação;
- De forma similar, controlar o tráfego entre serviços;
- Controlar o quanto de recursos (e custos) uma função pode consumir ao escalar automaticamente.

## Configurando os valores máximos de concurrency via Serverless

O valor máximo definido na propriedade vai limitar o número de instâncias simultâneas de uma função que podem ser chamadas (ou invocadas) por um evento SQS. O valor mínimo é `2` e o máximo `1000`. Caso não queira configurar um limite, basta não acrescentar a propriedade para que a AWS Lambda trabalhe sempre com a quantidade máxima de instâncias simultâneas (`1000`).

```yml
functions:
 funcaoExemplo:
   handler: src/functions/funcaoExemplo/index.funcaoExemplo
   events:
     - sqs:
         arn:
           Fn::GetAtt:
             - FilaGatilhoExemplo
             - Arn
         batchSize: 1
         maximumConcurrency: 10
```

Para mais detalhes, você pode consultar a documentação da AWS sobre o assunto - lembrando que nem todos os casos cobertos pela documentação são específicos para aplicações Serverless:

- [Configurando max concurrency](https://docs.aws.amazon.com/lambda/latest/dg/with-sqs.html#events-sqs-max-concurrency);
- [Gerenciando concurrency em funções lambda](https://aws.amazon.com/blogs/compute/managing-aws-lambda-function-concurrency/).
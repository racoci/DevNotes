# 3.13 Para saber mais: Troubleshooting

### Erro de resolução de promessas

Se, ao invés dos dados solicitados (por exemplo, um array de objetos ou um objeto livro), alguma das variáveis estiver retornando o valor `Promise { <pending> }`, é possível que exista alguma promessa não resolvida em alguma parte do código.

Verifique se todas as funções assíncronas do projeto, em especial as que fazem chamadas a métodos do Mongoose, estão devidamente assinaladas com `async/await`. Por exemplo:

```js
app.get('/livros', async (req, res) => {
 const listaLivros = await livro.find({});
 res.status(200).json(listaLivros);
});
```

Note que, no caso de funções callback, a palavra-chave `async` deve ser adicionada antes dos parâmetros e `await` antes da instrução da variável.

No caso de declarações de função, `async` deve ser adicionada antes de `function`:

```js
async function conectaNaDatabase() {
 mongoose.connect(process.env.DB_CONNECTION_STRING);
 return mongoose.connection;
}
```

Note que, no exemplo acima, não é necessário adicionar `await` pois `return` já é implicitamente assíncrono.

Em caso de dúvidas, basta consultar os commits feitos no [repositório do curso no GitHub](https://github.com/alura-cursos/3266-express-mongo/commits/aula-3).

### Nome do banco

Não esqueça de adicionar o nome da database `livraria` na string de conexão do Mongo Atlas, após o caminho principal, conforme feito em vídeo:

```bash
mongodb+srv://admin:<suasenha>@cluster0.uvmwiwx.mongodb.net/livraria?retryWrites=true&w=majority
```

Isso garante que a conexão será feita para a database correta e a coleção `livros` será criada nesta database, especialmente se você tiver outras databases de teste em seu cluster.